<div class="modal-header card-header" style="background-color:rgb(0, 51, 102); color:seashell">
  <strong> {{ pageTitle }}</strong>
  <button
    type="button"
    class="close"
    aria-label="Close"
    style="color:white"
    (click)="activeModal.dismiss('Cross click')"
  >
    <span aria-hidden="true">&times;</span>
  </button>
</div>
<div class="modal-body rowflex" style="height: 100%; width: 100%">
  <div class="w3-sidebarmod" style="order:0;">
    <h6>Navigation History</h6>
    <button
      class="btn btn-light"
      style="width:100%"
      (click)="fullRestart()"
      *ngIf="currentDepartment"
    >
      Restart
    </button>
    <ng-container *ngIf="currentNav">
      <span *ngFor="let nav of currentNav">
        <span (click)="trackAndSelectWorkflow(null, nav[0][0])" class="fakelink"
          >Return to {{ nav[0] }}</span
        ><br />
        {{ nav[1] }} <i class="icon-right" aria-hidden="true"></i> {{ nav[2] }} <br /><br />
      </span>
    </ng-container>
    <div *ngIf="!currentNav">No history to display</div>
  </div>
  <div class="w3-sidebarmod" style="order:2;">
    <div style="height:70%; top: 0;">
      <form [formGroup]="siForm">
        <div class="sidewrapper">
          <div style="display:inline-block">
            <label for="azotel">Azotel ID:</label>
          </div>
          <input id="azotel" formControlName="azotelId" />
          <!-- <button
          class="btn btn-light"
          (click)="(retrieveAzotel)"
          style="height: 60%; display: inline-block;"
        >
          Retrieve
        </button> -->
        </div>
        <div class="sidewrapper">
          <label for="apName">AP Name:</label>
          <br />
          <input id="apName" formControlName="apName" />
          <br />
          <label for="apIP">AP IP:</label>
          <br />
          <input id="apIP" formControlName="apIP" />
          <br />
        </div>
        <div class="sidewrapper">
          <label for="cpeMAC">CPE MAC:</label><br />
          <input id="cpeMAC" formControlName="cpeMAC" /><br />
          <label for="cpeIP">CPE IP:</label><br />
          <input id="cpeIP" formControlName="cpeIP" />
        </div>
      </form>
    </div>
    <div style="height:30%; bottom:0;">
      <ng-container *ngIf="infoData">
        <span>Disposition Codes: <br /></span>
        <span *ngIf="infoData.disposition[0][1]">Type: {{ infoData.disposition[0][1] }}<br /></span>
        <span *ngIf="infoData.disposition[1][1]"
          >Case Classification: {{ infoData.disposition[1][1] }}<br
        /></span>
        <span *ngIf="infoData.disposition[2][1]"
          >Primary Disposition Code: {{ infoData.disposition[2][1] }}<br
        /></span>
        <span *ngIf="infoData.disposition[3][1]"
          >Secondary Disposition Code: {{ infoData.disposition[3][1] }}<br
        /></span>
        <span *ngIf="infoData.disposition[4][1]"
          >Resolution Code: {{ infoData.disposition[4][1] }}</span
        >
      </ng-container>
    </div>
  </div>
  <div class="columnflex" style="order: 1; margin: 10px; margin-bottom:25px" style="flex:1">
    <div class="w3-bar horiznav">
      <ng-container *ngIf="infoData">
        <div class="rowflex">
          <span style="order: 1" *ngIf="!showTextBox">{{ infoData.why }}</span>
          <textarea
            *ngIf="showTextBox"
            style="width: 80%; height: 80%; order: 1"
            placeholder="Your current location in the workflow is automatically reported"
            [(ngModel)]="textReport"
          ></textarea>
          <ng-container *ngIf="!showTextBox">
            <button class="btn btn-light reportbutton" (click)="openReporting()">
              Feature Request/Bug Report
            </button></ng-container
          >
          <ng-container *ngIf="showTextBox" class="reportbutton">
            <button class="btn btn-light" (click)="reportProblem('Feature Request')">
              Requesting a Feature
            </button>
            <button class="btn btn-light" (click)="reportProblem('Bug Report')">
              Reporting a Bug
            </button></ng-container
          >
        </div>
        <a
          *ngIf="infoData.learnMore && infoData.learnMore.startsWith('http')"
          href="{{ infoData.learnMore }}"
          >Learn More</a
        >
      </ng-container>
    </div>
    <form [formGroup]="siForm" style="flex:1">
      <div class="w3-bar enborder" style="position:relative; padding: 5px;height:75%">
        <ng-container *ngIf="!azotelIdEntered">
          <div class="card-header bg-secondary option-banner">
            <strong>Enter the Azotel ID to Proceed</strong>
          </div>
          <button (click)="submitAzotelId()" class="btn btn-light btn-select">Proceed</button>
        </ng-container>
        <ng-container *ngIf="!currentDepartment && azotelIdEntered">
          <div class="card-header bg-secondary option-banner">
            <strong> Choose Your Department:</strong>
          </div>

          <button
            *ngFor="let department of departments; let i = index"
            class="btn btn-light btn-select"
            (click)="setDepartment(i)"
          >
            {{ department.department }}
          </button>
        </ng-container>
        <ng-container *ngIf="currentDepartment && !currentWorkflow">
          <div class="card-header bg-secondary option-banner">
            <strong>{{ workflowText }}</strong>
          </div>
          <button
            *ngFor="
              let workflow of currentDepartment.workflows | slice: 0:visibleWorkflowCount;
              let i = index
            "
            class="btn btn-light btn-select"
            (click)="selectWorkflow(i)"
          >
            {{ workflow.workflowName }}
          </button>
        </ng-container>
        <ng-container *ngIf="infoData">
          <div class="card-header bg-secondary option-banner">
            <strong> What to Do: {{ currentWorkflow.label }}</strong>
          </div>
          <div style="white-space: pre-line" *ngIf="!infoDataDataType">{{ infoData.what }}</div>
          <ng-container *ngIf="infoDataDataType">
              <span style="white-space: pre-wrap">{{ jsonInfoDataWhat }}
            </span>
          </ng-container>
          <ng-container *ngIf="currentWorkflow.options && currentWorkflow.options[0][1]">
            <button
              *ngFor="let option of currentWorkflow.options; let i = index"
              class="btn btn-light btn-select"
              (click)="trackAndSelectWorkflow(i)"
            >
              {{ option[0] }}
            </button>
          </ng-container>
          <ng-container *ngIf="currentWorkflow.step[0] === 'R'">
            <button
              (click)="moveToDifferentFlow(currentWorkflow.options[0][0])"
              class="btn btn-info dangerbuttons"
              *ngIf="infoData.learnMore === 'Continue'"
            >
              Move to {{ currentWorkflow.options[0][0] }} Workflow
            </button>
            <button (click)="clearCurrentWorkflow()" class="btn btn-info dangerbuttons">
              Restart
            </button>
            <button (click)="fullRestart()" class="btn btn-danger dangerbuttons">
              Restart and Clear Notes
            </button>
            <button class="btn btn-danger dangerbuttons" (click)="activeModal.close('Close click')">
              Close
            </button>
          </ng-container>
        </ng-container>
      </div>
      <textarea
        placeholder="Add notes here..."
        style="text-align:justify; padding: 4px 0px 4px 0px; width: 99%; height: 25%; resize:none; margin: 25px 10px"
        formControlName="autobox"
      ></textarea>
    </form>
    <div style="order:3; height:25px"></div>
  </div>
</div>
<div class="modal-footer"></div>
